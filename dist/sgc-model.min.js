define("Collection/mixins/collectionHelpers",[],function(){return function(){return{isEmpty:function(){return 0===this.length},previousModel:function(t){if(t){var e=this.indexOf(t);if(-1!==e)return this.at(e-1)}},nextModel:function(t){if(t){var e=this.indexOf(t);if(-1!==e)return this.at(e+1)}},remove:function(t,e){if(e=_.defaults(e||{},{predicate:null}),e.predicate&&_.isFunction(e.predicate)){var i=this.filter(e.predicate);return this.remove(i),i}return Backbone.Collection.prototype.remove.apply(this,arguments)},clear:function(t){var e=this.models;this.reset([]);for(var i=e.length-1;i>=0;i--)e[i].clear(t);this.stopListening(),this.parent&&(this.parent=null)},where:function(t,e){return _.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){return e.equal(t)?!0:void 0})},clone:function(t){t||(t={});var e=t.models||this.models,i=new this.constructor(e,{url:this.url,parent:this.parent});return i.sgSort(_.clone(this.getSGSort())),i.sgFilter(_.clone(this.getSGFilter())),i.sgPaginate(_.clone(this.getSGPaginate())),i}}}}),define("Collection/mixins/collectionPagination",[],function(){return function(){return{_paginate:{currentPage:0,perPage:0,maxPages:0,_maxPagesReached:!1,dummyModels:!1},isMaxReached:function(){return this._paginate._maxPagesReached},removePaginate:function(){this._paginate={currentPage:0,perPage:0,maxPages:0,_maxPagesReached:!1}},resetPaginate:function(){this._paginate.currentPage=0,this._paginate._maxPagesReached=!1,this._pagesAlreadyFetched=null},sgPaginate:function(t){return _.extend(this._paginate,t),this},getSGPaginate:function(){return this._paginate},_preparePaginateFetchOptions:function(t){t=_.defaults(t||{},{data:{},first:null,remove:!1,success:null}),this._paginate.perPage&&(t.data.offset=this._paginate.currentPage*this._paginate.perPage,t.data.limit=this._paginate.perPage);var e=t.success,i=this;return t.success=function(n,r){var s=r;return t.parse&&(s=i.parse(r,t)),i._paginate.currentPage++,i._paginate._maxPagesReached=i._paginate.currentPage===i._paginate.maxPages||s.length<i._paginate.perPage,e&&e.apply(this,arguments)},t},nextPage:function(t){return t=_.defaults(t||{},{paginate:!0}),this.isMaxReached()?!1:(t.first&&(this._paginate.currentPage=0),this.fetch(t))},getPage:function(t){return t||(t={data:{}}),t.remove=!1,t.data||(t.data={}),this._paginate.perPage&&null!=t.page&&(t.data.offset=t.page*this._paginate.perPage,t.data.limit=(t.numberPages||1)*this._paginate.perPage),this.dummyFetch(t)},fillPage:function(t){if(null!=t.page){this._pagesAlreadyFetched=this._pagesAlreadyFetched||[];var e=t.numberPages||1;if(t.refill||!this._pagesAlreadyFetched.contains(t.page)){this._pagesAlreadyFetched.push(t.page);for(var i=t.page*this._paginate.perPage,n=i+e*this._paginate.perPage,r=this,s=function(){return n-r.length};s()>0;)this.add({});return this.getPage(t).done(function(t){t.forEach(function(t,e){console.log(i),r.models[i+e].set(t)})})}}},resetSGSort:function(){this.sgSort({})},sgSort:function(t){return this._sort=t,this},getSGSort:function(){return this._sort||(this._sort={}),this._sort},addSGSort:function(t,e,i){i=_.defaults(i||{},{silent:!1}),this.getSGSort()[t]=e,i.silent||(this.trigger("change"),this.trigger("add:sort",t,e))},removeSGSort:function(t,e){e=_.defaults(e||{},{silent:!1}),delete this.getSGSort()[t],e.silent||(this.trigger("change"),this.trigger("add:sort",t))},resetSGFilter:function(){this.sgFilter({})},sgFilter:function(t){return this._filters=t,this},getSGFilter:function(){return this._filters||(this._filters={}),this._filters},addSGFilter:function(t,e,i){i=_.defaults(i||{},{silent:!1}),this.getSGFilter()[t]=e,i.silent||(this.trigger("change"),this.trigger("add:filter",t,e))},removeSGFilter:function(t,e){e=_.defaults(e||{},{silent:!1}),delete this.getSGFilter()[t],e.silent||(this.trigger("change"),this.trigger("remove:filter",t))},_prepareQueryOptions:function(t){t=_.defaults(t||{},{data:{}}),this._sort&&("string"==typeof this._sort?t.data.sortBy=this._sort:(t.data.sortBy=this._sort.keys()[0],t.data.sortHow=this._sort[t.data.sortBy]));for(var e in this._filters)t.data[e]=this._filters[e];return t}}}}),define("Collection/mixins/collectionSync",[],function(){return function(){return{_isLoading:!1,fetch:function(t){t=_.defaults(t||{},{paginate:!1}),t.paginate&&(t=this._preparePaginateFetchOptions(t)),t=this._prepareQueryOptions(t),this._isLoading=!0,this.trigger("loading-start");var e=t.success,i=this;return t.success=function(){i._isLoading=!1,i.trigger("Fetch:success"),i.trigger("loading-stop"),e&&e.apply(this,arguments)},t.error=function(t){t&&t.apply&&t.apply(this,arguments),i.trigger("Fetch:error",t),i._isLoading=!1,i.trigger("loading-stop")},Backbone.Collection.prototype.fetch.apply(this,[t])},isLoading:function(){return this._isLoading}}}}),define("Utils/utils",[],function(){var t={};return t.asGetter=function(e){return"get"+t.capitalize(e)},t.asSetter=function(e){return"set"+t.capitalize(e)},t.capitalize=function(t){var e="",i=t.split(".");return i.forEach(function(t){e+=t.charAt(0).toUpperCase()+t.slice(1)}),e},t.contains=function(t,e){return~t.indexOf(e)},t.startsWith=function(t,e){return t.slice(0,e.length)===e},t.endsWith=function(t,e){return t.slice(t.length-e.length,t.length)===e},t}),define("Model/mixins/modelSchemaPropertiesDefinition",["../../Utils/utils"],function(t){return function(){return{_generateGetSetForAttributes:function(t){for(var e=t.length-1;e>=0;e--)this._generateGetSetForAttribute(t[e])},_generatedGetterAndSetter:function(){return this.__generatedGetterAndSetter||(this.__generatedGetterAndSetter={}),this.__generatedGetterAndSetter},_generateGetSetForAttribute:function(t){if(!this._generatedGetterAndSetter()[t]){var e={},i=this._defineGetter(t);i&&(e.get=i);var n=this._defineSetter(t);n&&(e.set=n),Object.defineProperty(this,t,e),this._generatedGetterAndSetter()[t]=e}},_defineGetter:function(e){return this.__existGetterForAttribute(e)?this[t.asGetter(e)]:function(){return this.get(e)}},_defineSetter:function(e){return this.__existSetterForAttribute(e)?this[t.asSetter(e)]:function(t){return this.set(e,t)}}}}}),define("Model/mixins/modelGetter",["../../Utils/utils"],function(t){return function(){return{__existGetterForAttribute:function(e){if(!_.isString(e))return!1;var i=t.asGetter(e);return i in this&&_.isFunction(this[i])},get:function(e,i){return i=_.defaults(i||{},{getterForce:!1}),!i.getterForce&&this.__existGetterForAttribute(e)?this[t.asGetter(e)](e,_.clone(i||{})):Backbone.Model.prototype.get.apply(this,arguments)}}}}),define("Model/mixins/modelSetter",["../../Utils/utils"],function(t){return function(){return{__existSetterForAttribute:function(e){if(!_.isString(e))return!1;var i=t.asSetter(e);return i in this&&_.isFunction(this[i])},set:function(e,i,n){return _.isObject(e)&&_.isObject(i)&&!n&&(n=i),n=_.defaults(n||{},{setterForce:!1,setEach:!1}),!n.setterForce&&this.__existSetterForAttribute(e)?this[t.asSetter(e)](i,_.clone(n||{})):n.setEach&&_.isObject(e)?void _.each(e,function(t,i){this.set(i,t,_.clone(n),e)},this):Backbone.Model.prototype.set.apply(this,[e,i,n])}}}}),define("Model/mixins/modelEvents",["../../Utils/utils"],function(t){function e(t){var e={},i=t.replace("change:","");return e.submodelName=i.split(".")[0],e.subTrigger="change:"+i.replace(e.submodelName+".",""),e}var i=require("backbone");return function(){return{__isMpathTrigger:function(e){return _.isString(e)&&t.contains(e,".")&&t.startsWith(e,"change:")},on:function(t,n,r){if(this.__isMpathTrigger(t)){var s=e(t),o=this.get([s.submodelName]);if(o instanceof i.Model)return void o.on(s.subTrigger,n,r);throw new Error("Unknow model")}return i.Model.prototype.on.apply(this,arguments)},off:function(n,r,s){if(_.isString(n)&&t.contains(".",n)&&t.startsWith(n,"change:")){var o=e(n),a=this.get([o.submodelName]);if(a instanceof i.Model)return void a.off(o.subTrigger,r,s);throw new Error("Unknow model")}return i.Model.prototype.off.apply(this,arguments)}}}}),define("Model/mixins/modelHelpers",[],function(){return function(){return{query:function(t){if(!t)return void 0;for(var e in t)if(_.isFunction(t[e])){if(!t[e](this.get(e)))return!1}else if(t[e]!==this.get(e))return!1;return!0}}}}),define("Model/Model",["./mixins/modelSchemaPropertiesDefinition","./mixins/modelGetter","./mixins/modelSetter","./mixins/modelEvents","./mixins/modelHelpers"],function(t,e,i,n,r){var s=require("backbone"),o=s.Model.extend({constructor:function(t,e){if(e=_.defaults(e||{},{automaticGetterAndSetter:!1}),_.isString(t)){var i=t;t={},t[this.idAttribute]=i}var n=s.Model.prototype.constructor.apply(this,[t,e]);return e.automaticGetterAndSetter&&t&&this._generateGetSetForAttributes(_.keys(t)),n},clear:function(){return this.stopListening(),this.collection&&(this.collection=null),this._SGISCLEARED=!0,s.Model.prototype.clear.apply(this,arguments)}});return _.extend(o.prototype,n(o)),_.extend(o.prototype,t(o)),_.extend(o.prototype,e(o)),_.extend(o.prototype,i(o)),_.extend(o.prototype,r(o)),o}),define("Collection/Collection",["./mixins/collectionHelpers","./mixins/collectionPagination","./mixins/collectionSync","../Model/Model"],function(t,e,i,n){var r=require("backbone"),s=r.Collection.extend({model:n,constructor:function(t,e){e=_.defaults(e||{},{url:null,parent:null}),this.removePaginate(),this.resetSGSort(),this.resetSGFilter(),e.url&&(this.url=e.url),e.parent&&(this.parent=e.parent);var i=r.Collection.prototype.constructor.apply(this,arguments);return i}});return _.extend(s.prototype,t(s)),_.extend(s.prototype,e(s)),_.extend(s.prototype,i(s)),s}),define("sgc-model",["require","./Collection/Collection","./Model/Model","./Utils/utils"],function(t){var e=t("./Collection/Collection"),i=t("./Model/Model"),n=t("./Utils/utils");return{Collection:e,Model:i,utils:n}});